image:
  - Visual Studio 2022 # Windows Server 2019
  - Visual Studio 2017 # Windows Server 2016
  - Visual Studio 2015 # Windows Server 2012 R2
environment:
  global:
    MESA_DIST_WIN_BUILD: msvc
    MESA_DIST_WIN_VER: $(configuration)
    #GALLIUM_DRIVER: llvmpipe|d3d12
    QT_OPENGL_DLL: opengl32
    #QT_OPENGL: software
    # QT_LOGGING_RULES: qt.qpa.gl=true
configuration:
  - 25.1.4
  - 25.0.7
  - 24.3.4
  - 24.2.8
  - 24.1.5
  - 24.0.7
  - 23.0.1
build_script:
  - appveyor version
  - ver
  - systeminfo | findstr /B /C:"OS Name" /C:"OS Version"
  - curl -C - -LO https://github.com/knossos-project/knossos/releases/download/nightly-dev/win.master-KNOSSOS.nightly.exe
before_test:
  - curl --fail -JLO https://github.com/pal1000/mesa-dist-win/releases/download/%MESA_DIST_WIN_VER%/mesa3d-%MESA_DIST_WIN_VER%-release-%MESA_DIST_WIN_BUILD%.7z
  - 7z e "-i!x64/*.dll" "-i!x64/*.json" "mesa3d-*-release-*.7z"
test_script:
  - win.master-KNOSSOS.nightly.exe exit
